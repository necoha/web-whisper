# Web Whisper - Windows ユーザーガイド

## 📱 Web Whisper とは

Web Whisper は、音声ファイルや動画ファイルを高精度で文字起こしするWindows対応アプリケーションです。OpenAI の Whisper AI を使用し、NVIDIA GPU 加速により高速処理を実現します。

## 💻 システム要件

### 最小要件
- Windows 10 (64ビット) または Windows 11
- メモリ: 4GB RAM 以上
- ストレージ: 2GB 以上の空き容量
- インターネット接続（初回モデルダウンロード時のみ）

### 推奨要件
- Windows 11 (64ビット)
- メモリ: 8GB RAM 以上
- NVIDIA GPU（CUDA 対応）
- NVIDIA ドライバー 551.xx 以上

## 📦 インストール方法

### 1. ダウンロード

[GitHub Releases](https://github.com/necoha/web-whisper/releases) から最新版をダウンロードします：

- **推奨**: `web-whisper-windows-x64.msi` - MSI インストーラー
- **代替**: `web-whisper-windows-x64-installer.exe` - EXE インストーラー

### 2. インストール

#### MSI インストーラーの場合
1. ダウンロードした `web-whisper-windows-x64.msi` をダブルクリック
2. インストールウィザードの指示に従って進む
3. 「完了」をクリックしてインストール完了

#### EXE インストーラーの場合
1. ダウンロードした `web-whisper-windows-x64-installer.exe` をダブルクリック
2. Windows Defender が警告を表示する場合、「詳細情報」→「実行」をクリック
3. インストールウィザードの指示に従って進む

### 3. 初回起動

1. スタートメニューから「Web Whisper」を検索して起動
2. 初回起動時は Whisper モデルのダウンロードが始まります（約1-2GB）
3. ダウンロード完了後、アプリが使用可能になります

## 🎤 基本的な使用方法

### 1. アプリの起動

スタートメニューまたはデスクトップショートカットから「Web Whisper」を起動します。

### 2. 音声ファイルの選択

**方法1: ドラッグ&ドロップ**
- 文字起こししたい音声・動画ファイルをアプリウィンドウにドラッグ&ドロップ

**方法2: ファイル選択**
- 「ファイルを選択」ボタンをクリックしてファイルを選択

### 3. モデル選択（v0.2.1以降）

処理速度と精度のバランスに応じてモデルを選択できます：

- **🎯 High Accuracy**: 最高精度（時間がかかる）
- **🚀 Fast**: 高精度で高速
- **⚖️ Balanced**: バランス型
- **⚡ Fastest**: 最高速（精度は標準）

### 4. 文字起こし実行

「文字起こし開始」ボタンをクリックして処理を開始します。

### 5. 結果の保存

文字起こしが完了すると、自動的に元のファイル名と同じ名前のテキストファイルが作成されます。

例: `会議録音.mp3` → `会議録音.txt`

## 📄 対応ファイル形式

### 音声形式
- MP3
- WAV
- M4A
- FLAC
- AAC

### 動画形式
- MP4
- AVI
- MOV
- MKV
- WMV

## ⚡ GPU 加速について

### GPU 情報の確認

アプリ起動時に GPU 情報が表示されます：

- **🎮 NVIDIA GPU (RTX 4070) - CUDA加速**: GPU 加速が有効
- **💻 Intel(R) Iris(R) Xe Graphics (CPU処理)**: Intel内蔵GPU、CPU処理モード
- **💻 CPU処理 (GPU検出失敗)**: CPU モードで動作

### Intel IRIS Graphics について

Intel内蔵GPU（IRIS Graphics、UHD Graphics等）をお使いの場合：

- **動作**: 問題なく動作します
- **処理**: CPU処理モードで実行されます（CUDA非対応のため）
- **速度**: NVIDIA GPU より遅くなりますが、十分実用的です
- **精度**: GPU版と同じ高精度を維持します

**処理時間の目安（Intel IRIS Graphics）**:
- 1分音声: 約2-3分
- 10分音声: 約20-30分  
- 1時間音声: 約2-3時間

**最適化のコツ**:
- ⚡ **Fastest** または ⚖️ **Balanced** モデルを選択
- 8GB以上のRAMを推奨
- 長時間録音は10-15分ずつに分割

### NVIDIA GPU ドライバーの更新

GPU 加速を有効にするには、最新のドライバーが必要です：

1. [NVIDIA ドライバーダウンロード](https://www.nvidia.com/drivers/)にアクセス
2. グラフィックカードを選択してドライバーをダウンロード
3. インストール後、PC を再起動
4. Web Whisper を再起動して GPU 認識を確認

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. アプリが起動しない

**症状**: ダブルクリックしても何も起こらない

**解決方法**:
- Windows Defender の除外設定にアプリを追加
- 管理者権限で実行を試す
- ウイルス対策ソフトの一時無効化

#### 2. 「GPU情報の取得に失敗した」と表示される

**症状**: GPU が認識されない

**解決方法**:
- NVIDIA ドライバーを最新版に更新
- CUDA Toolkit のインストール確認
- PC の再起動

#### 3. 文字起こしエラー

**症状**: 「Transcription error: [Errno 2] No such file or directory: 'ffmpeg'」

**解決方法**:
- アプリを最新版に更新（v0.2.1以降で修正済み）
- FFmpeg が自動インストールされない場合は手動インストール

#### 4. 音声ファイルが認識されない

**症状**: ファイルを選択しても読み込まれない

**解決方法**:
- 対応ファイル形式を確認
- ファイルが破損していないか確認
- ファイル名に日本語以外の特殊文字が含まれていないか確認

#### 5. 処理が異常に遅い

**症状**: 小さなファイルの処理に長時間かかる

**解決方法**:
- GPU 加速が有効になっているか確認
- より高速なモデル（⚡ Fastest）を選択
- 他のアプリを閉じてメモリを確保

#### 6. 「Failed to spawn Python Process: ディレクトリ名が無効です」エラー

**症状**: アプリ起動時にPythonプロセスエラーが発生

**解決方法**:
- v0.2.2以降に更新（修正済み）
- アプリを管理者権限で実行
- インストールパスに日本語や特殊文字が含まれていないか確認
- アンインストール後、再インストールを試行

### エラーコードと対処法

| エラーメッセージ | 原因 | 対処法 |
|------------------|------|--------|
| `CUDA DLL not found` | NVIDIA ドライバーが古い | ドライバーを551.xx以降に更新 |
| `Model download failed` | インターネット接続エラー | 接続を確認して再試行 |
| `Permission denied` | ファイルアクセス権限エラー | 管理者権限で実行 |
| `Out of memory` | メモリ不足 | より小さなモデルを選択 |
| `ディレクトリ名が無効です (os error 267)` | Windows パス処理エラー | v0.2.2以降に更新 |
| `FFmpeg not found` | FFmpeg パスエラー | v0.2.1以降で自動解決 |

## 💡 使用のコツ

### 1. 最適なモデル選択

- **会議録音**: High Accuracy または Balanced
- **日常会話**: Fast または Balanced  
- **長時間録音**: Fastest（速度優先）
- **重要な内容**: High Accuracy（精度優先）

### 2. 音声ファイルの準備

- **推奨**: WAV または FLAC 形式（無劣化）
- **ノイズ除去**: 事前にノイズを除去すると精度向上
- **音量調整**: 適切な音量に調整
- **ファイルサイズ**: 長時間録音は分割して処理

### 3. 処理速度の最適化

- **GPU 加速**: NVIDIA GPU ドライバーを最新に保つ
- **メモリ**: 他のアプリを閉じて RAM を確保
- **ストレージ**: SSD 使用で読み込み速度向上

## 🔒 プライバシーとセキュリティ

- **オフライン処理**: インターネット接続不要（モデルダウンロード後）
- **データ保護**: 音声ファイルはローカルでのみ処理
- **一時ファイル**: 処理後の一時ファイルは自動削除

## 📞 サポート

### 問題報告

問題や不具合がある場合は、以下の情報と共に [GitHub Issues](https://github.com/necoha/web-whisper/issues) までご報告ください：

- Windows バージョン
- GPU モデル（該当する場合）
- エラーメッセージの全文
- 問題発生時の手順

### よくある質問

**Q: 無料で使用できますか？**
A: はい、完全無料でオープンソースです。

**Q: インターネット接続は必要ですか？**
A: 初回のモデルダウンロード時のみ必要です。その後はオフラインで使用可能です。

**Q: どの程度の精度ですか？**
A: クリアな音声であれば95%以上の高精度を実現します。

**Q: 商用利用は可能ですか？**
A: ライセンス条項に従って利用可能です。詳細は プロジェクトページをご確認ください。

---

**バージョン**: v0.2.1  
**最終更新**: 2025年8月14日  
**サポート**: [GitHub Issues](https://github.com/necoha/web-whisper/issues)